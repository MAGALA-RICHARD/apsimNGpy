{
  "$type": "Models.Core.Simulations, Models",
  "ExplorerWidth": 300,
  "Version": 131,
  "ApsimVersion": "0.0.0.0",
  "Name": "Simulations",
  "Children": [
    {
      "$type": "Models.Storage.DataStore, Models",
      "useFirebird": false,
      "CustomFileName": null,
      "Name": "DataStore",
      "Children": [],
      "IncludeInDocumentation": true,
      "Enabled": true,
      "ReadOnly": false
    },
    {
      "$type": "Models.Core.Simulation, Models",
      "IsRunning": false,
      "Descriptors": null,
      "Name": "Simulation",
      "Children": [
        {
          "$type": "Models.Clock, Models",
          "Start": "2014-02-01T00:00:00",
          "End": "2016-11-30T00:00:00",
          "Name": "clock",
          "Children": [],
          "IncludeInDocumentation": true,
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Climate.Weather, Models",
          "ConstantsFile": null,
          "FileName": "%root%\\Examples\\WeatherFiles\\lincoln.met",
          "ExcelWorkSheetName": "",
          "Name": "Weather",
          "Children": [],
          "IncludeInDocumentation": true,
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Summary, Models",
          "CaptureErrors": true,
          "CaptureWarnings": true,
          "CaptureSummaryText": true,
          "Name": "summaryfile",
          "Children": [],
          "IncludeInDocumentation": true,
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Soils.Arbitrator.SoilArbitrator, Models",
          "Name": "Soil Arbitrator",
          "Children": [],
          "IncludeInDocumentation": true,
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Core.Zone, Models",
          "Area": 1.0,
          "Slope": 0.0,
          "AspectAngle": 0.0,
          "Altitude": 50.0,
          "Name": "Field",
          "Children": [
            {
              "$type": "Models.Core.Folder, Models",
              "ShowPageOfGraphs": false,
              "Name": "Management",
              "Children": [
                {
                  "$type": "Models.Operations, Models",
                  "Operation": [
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-03-20",
                      "Action": "[RedClover].Sow(population: 500, cultivar: \"Colenso\", depth: 5, rowSpacing: 150)",
                      "Enabled": true
                    }
                  ],
                  "Name": "Sowing",
                  "Children": [],
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Operations, Models",
                  "Operation": [
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-10-31",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-03",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-05",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-07",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-10",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-11",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-12",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-17",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-18",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-19",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-24",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-25",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-27",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-01",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-02",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-04",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-08",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-09",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-12",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-15",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-17",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-19",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-20",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-21",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-22",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-25",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-26",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-27",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-28",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-29",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-30",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-02",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-05",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-08",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-09",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-12",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-13",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-16",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-19",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-20",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-21",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-26",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-27",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-01-29",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-02",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-04",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-05",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-09",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-11",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-12",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-16",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-17",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-18",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-24",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-26",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-27",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-02",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-03",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-05",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-10",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-12",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-13",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-16",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-19",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-20",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-23",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-24",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-26",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-30",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-04-02",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-04-03",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-04-06",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-04-08",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-04-17",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-05-20",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-06-09",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-09-09",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-09-30",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-02",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-06",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-09",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-12",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-13",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-16",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-20",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-21",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-23",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-26",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-27",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-02",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-03",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-04",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-06",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-09",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-11",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-16",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-18",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-20",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-23",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-24",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-25",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-27",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-30",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-01",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-04",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-07",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-09",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-10",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-22",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-24",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-26",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-29",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-31",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-01",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-07",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-09",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-11",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-12",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-13",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-15",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-21",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-25",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-30",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-02",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-03",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-05",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-08",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-11",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-12",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-15",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-16",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-22",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-23",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-25",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-26",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-01",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-02",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-04",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-07",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-08",
                      "Action": "[Irrigation].Apply(amount: 4, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-10",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-14",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-15",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-18",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-21",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-22",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-23",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-03-28",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-04-02",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-04-08",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-05-04",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-08-31",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-09-30",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-10-01",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-10-05",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-10-12",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-10-18",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-10-19",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-10-27",
                      "Action": "[Irrigation].Apply(amount: 10, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-10-31",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-01",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-03",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-08",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-10",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-11",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-14",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-21",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-22",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-23",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-24",
                      "Action": "[Irrigation].Apply(amount: 7, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-28",
                      "Action": "[Irrigation].Apply(amount: 8, efficiency: 0.8)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-29",
                      "Action": "[Irrigation].Apply(amount: 9, efficiency: 0.8)",
                      "Enabled": true
                    }
                  ],
                  "Name": "IrrigationSchedule",
                  "Children": [],
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Operations, Models",
                  "Operation": null,
                  "Name": "NRate",
                  "Children": [],
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Operations, Models",
                  "Operation": [
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-10-23",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-11-25",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2014-12-30",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-02-04",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-03-10",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-04-16",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-06-09",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-10-06",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-11-16",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2015-12-16",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-01-25",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-02-24",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-04-09",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-05-24",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-10-03",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    },
                    {
                      "$type": "Models.Operation, Models",
                      "Date": "2016-11-11",
                      "Action": "[DefoliationManager].Script.Defoliate(defoliationType: \"Cut\", amountDM: 40, amountType: \"ResidualDM\", duration: 1)",
                      "Enabled": true
                    }
                  ],
                  "Name": "DefoliationSchedule",
                  "Children": [],
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Manager, Models",
                  "Code": "// Performs defoliations, or removes biomass, from any existing plant (PMF and/or AgPasture) based on a set of given rules.  \n// Defoliations can be triggered automatically by this manager or be called from another Script or a Schedule model.\n// Developed by RCichota, last updated in 31/Mar/2019\n\nnamespace Models\n{\nusing Newtonsoft.Json;\nusing System.Linq;\nusing Models.PMF.Interfaces;\nusing Models.Interfaces;\nusing Models.PMF;\nusing Models.Soils;\nusing Models.Core;\nusing APSIM.Shared.Utilities;\nusing System.Collections.Generic;\nusing System.Xml.Serialization;\nusing System;\nusing Models.Soils.Nutrients;\n\n    [Serializable]\n    public class Script : Model\n    {\n        [Link] private Clock clock;\n        [Link] private Zone myZone;\n        [Link] private Soil mySoil;\n        [Link(ByName = true)] private ISolute Urea;\n        [Link] private ISummary mySummary;\n        public event BiomassRemovedDelegate BiomassRemoved;\n        private string baseDefoliationType;\n        private string typeOfDefoliation;\n        private string baseAmountType;\n        private string typeOfAmount;\n        private double amountGiven;\n        private double herbageToRemove;\n        private RemovalFractions defoliationFractions;\n        private int durationOfDefoliation;\n        private int daysDefoliating;\n        private double cumAmountHarvested;\n        private double atZ0;\n        private double atZ1;\n        private double fractionToRemove;\n        private double fractionToResidue;\n        private double speciesHarvestedWt;\n        private double speciesHarvestedN;\n        private double speciesFractionToRemove;\n        [Link]\n        private IPhysical soilPhysical;\n        //> Links to other Apsim models\n        //Auxiliary 'links'\n        private List<Plant> PMFSpecies = new List<Plant>();\n        private List<AgPasture.PastureSpecies> AgPSpecies = new List<AgPasture.PastureSpecies>();\n\n        //> Events raised by this manager\n\n        //> User inputs from properties tab\n        [Separator(\"Generic defoliation management - removes biomass from PMF and AgPasture species, plus residue management\")]\n        [Description(\"Allow this manager to control defoliations? \")]\n        public bool AutomaticManagementIsEnabled { get; set; }\n        [Description(\"Date to start the defoliation management (dd/mm/yyyy): \")]\n        public DateTime DefoliationRotationStartDate { get; set; }\n        [Description(\"Date to end the defoliation management (dd/mm/yyyy): \")]\n        public DateTime DefoliationRotationEndDate { get; set; }\n\n        [Separator(\"Parameters defining how the defoliation is managed\")]\n        [Description(\"What type of defoliation should be triggered? \")]\n        public DefoliationTypes DefoliateType { get; set; }\n        [Description(\"How the defoliations should be triggered? \")]\n        public DefoliationTriggerTypes DefoliationTriggerType { get; set; }\n        [Description(\"  Minimum number of days between defoliations, used if trigger is an interval: \")]\n        public int IntervalBetweenDefoliations { get; set; }\n        [Description(\"  Minimum standing biomass to start defoliations, used if trigger is DM target(g/m2): \")]\n        public int TargetStandingBiomass { get; set; }\n        [Description(\"Duration of each defoliation event (days): \")]\n        public int DurationOfEachDefoliation { get; set; }\n        [Description(\"Which amount is being defined? \")]\n        public DefoliateAmountTypes RemoveAmountType { get; set; }\n        [Description(\"DM amount to use (g/m2): \")]\n        public double AmountForEachDefoliation { get; set; }\n        [Description(\"For PMF species, allow all biomass to be removed? \")]\n        public bool RemoveAllBiomassIsEnabled { get; set; }\n\n        [Separator(\"Parameters defining the management of the defoliated biomass\")]\n        [Description(\"How much of the DM defoliated is to be removed from the field? \")]\n        public DMRemovalTypes DMRemoveType { get; set; }\n        [Description(\"  Fraction of DM to remove off field, if using UserDefinedFraction (0-1): \")]\n        public double FractionDMToRemove { get; set; }\n        [Description(\"How much of the N defoliated is to be removed from the field? \")]\n        public NRemovalTypes NRemoveType { get; set; }\n        [Description(\"  Fraction of N to remove off field, if using UserDefinedFraction (0-1): \")]\n        public double FractionNToRemove { get; set; }\n        [Description(\"How the non-removed material is returned to the field? \")]\n        public ReturnAsTypes ReturnType { get; set; }\n\n        [Separator(\"Parameters for partitioning non-removed N into urine and dung\")]\n        [Description(\"How the partition of N to dung and urine is defined? \")]\n        public DungNContentTypes NDungType { get; set; }\n        [Description(\"  Proportion of N returned in dung, if using DefineProportion (0-1): \")]\n        public double ProportionN2Dung { get; set; }\n        [Description(\"  The C:N of dung, if using DefineCNratio (typically around 20): \")]\n        public double CNRatioDung { get; set; }\n        [Description(\"Soil depth down to which urine should be applied (mm): \")]\n        public double UrineDepth { get; set; }\n\n        //> Outputs from this manager\n        [JsonIgnore][Units(\"g/m2\")] // Pasture DM defoliated (removed from plants) today\n        public double DefoliatedWt{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // N in the pasture material defoliated today\n        public double DefoliatedN{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // Pasture DM harvested (removed from plants minus direct residue) today\n        public double HarvestedWt{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // N in the pasture material harvested today\n        public double HarvestedN{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // Pasture DM actually removed from the field\n        public double RemovedWt{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // N in the pasture material removed from the field\n        public double RemovedN{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // Pasture DM returned by this manager to the field\n        public double ReturnedWt{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // N in the pasture material returned by this manager to the field\n        public double ReturnedN{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // Non-removed N returned as dung (to SurfaceOM)\n        public double NReturnedInDung{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // Non-removed N returned as urine (soil urea)\n        public double NReturnedInUrine{ get; set; }\n        [JsonIgnore][Units(\"days\")] // Number of days since the end of last defoliation event\n        public int DaysSinceLastDefoliation{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // Total standing aboveground DM before a defoliation\n        public double PreHarvestDM{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // Total standing aboveground DM after a defoliation\n        public double PostHarvestDM{ get; set; }\n        [JsonIgnore][Units(\"g/m2\")] // Total pasture DM harvested over a complete defoliation event\n        public double RotationHarvestedDM{ get; set; }\n\n        //> Internal variables\n        private double[] urineFraction;                  // fraction of urine to be applied in each soil layer\n        // auxiliary boolean\n        private bool aDefoliationHasHappened = false; // flag whether a defoliation has happened in this simulation run\n\n        // auxiliary - lists of species and removal fractions\n        private string[] swardSpeciesName;              // name of each species in the sward\n        private string[] swardSpeciesType;              // type of each species in the sward (PMF or AgPasture)\n        private double[] speciesFraction;              // biomass fraction of harvestable material of each species\n\n        [EventSubscribe(\"StartOfSimulation\")]\n        private void OnSimulationCommencing(object sender, EventArgs e)\n        {\n            // check the type of defoliation given\n            if (DefoliateType == DefoliationTypes.Cut)\n                baseDefoliationType = \"Cut\";\n            else if (DefoliateType == DefoliationTypes.Graze)\n                baseDefoliationType = \"Graze\";\n            else\n                baseDefoliationType = \"Harvest\";\n\n            // check the type of amount given\n            if (RemoveAmountType == DefoliateAmountTypes.DMToRemove)\n                baseAmountType = \"DMToRemove\";\n            else if (RemoveAmountType == DefoliateAmountTypes.ResidualDM)\n                baseAmountType = \"ResidualDM\";\n            else\n                baseAmountType = \"UseDefoliationFractions\";\n\n            // check the interval between events\n            if (IntervalBetweenDefoliations < 1)\n                throw new Exception(\"The interval between defoliation events must be at least one day\");\n\n            // check the duration for each defoliation\n            if(DurationOfEachDefoliation <= 0)\n                throw new Exception(\"The duration of defoliations cannot be zero or negative!\");\n\n            // check the fraction of defoliated material to remove from the field\n            if (DMRemoveType == DMRemovalTypes.RemoveAll)\n                FractionDMToRemove = 1.0;\n            else if (DMRemoveType == DMRemovalTypes.RemoveNone)\n                FractionDMToRemove = 0.0;\n            else if (DMRemoveType == DMRemovalTypes.BasedOnDigestibility)\n                FractionDMToRemove = -1.0;  // will be calculated dynamically\n            else // DMRemoveType == DMRemovalTypes.UserDefinedFraction\n            {\n                if (FractionDMToRemove < 0.0)\n                    throw new Exception(\"The fraction of DM defoliated to remove from the field cannot be negative!\");\n            }\n\n            // check the fraction of defoliated N to remove from the field\n            if (NRemoveType == NRemovalTypes.RemoveAll)\n                FractionNToRemove = 1.0;\n            else if (NRemoveType == NRemovalTypes.RemoveNone)\n                FractionNToRemove = 0.0;\n            else if (NRemoveType == NRemovalTypes.ProportionalToDM)\n                FractionNToRemove = FractionDMToRemove;\n            else // NRemoveType == NRemovalTypes.UserDefinedFraction\n            {\n                if (FractionNToRemove < 0.0)\n                    throw new Exception(\"The fraction of defoliated N to remove from the field cannot be negative!\");\n            }\n\n            // set up the links to all plant species\n            PMFSpecies = myZone.FindAllChildren<Plant>().ToList();\n            AgPSpecies = myZone.FindAllChildren<AgPasture.PastureSpecies>().ToList();\n\n            int numPlants = PMFSpecies.Count + AgPSpecies.Count;\n            swardSpeciesName = new string[numPlants];\n            swardSpeciesType = new string[numPlants];\n            int i = 0;\n            foreach (Plant species in myZone.FindAllChildren<Plant>().OfType<IModel>().ToList())\n            {\n                swardSpeciesName[i] = species.Name;\n                swardSpeciesType[i] = \"PMF\";\n                i += 1;\n            }\n            foreach (AgPasture.PastureSpecies species in myZone.FindAllChildren<AgPasture.PastureSpecies>().OfType<IModel>().ToList())\n            {\n                swardSpeciesName[i] = species.Name;\n                swardSpeciesType[i] = \"AgPasture\";\n                i += 1;\n            }\n\n            // initialise some variables\n            speciesFraction = new double[numPlants];\n            defoliationFractions = new RemovalFractions();\n            DaysSinceLastDefoliation = 0;\n            durationOfDefoliation = -1;\n            daysDefoliating = 0;\n            resetMyOutputs();\n\n            // set the fraction of urine for each layer\n            if (ReturnType == ReturnAsTypes.AsDungUrine)\n            {\n                double depthFromSurface = 0.0;\n                for (int layer = 0; layer < soilPhysical.Thickness.Length; layer++)\n                {\n                    depthFromSurface += soilPhysical.Thickness[layer];\n                    if (depthFromSurface >= UrineDepth)\n                    { // bottom layer found\n                        urineFraction = new double[layer + 1];\n                        double distFactor = 1.5;\n                        double totalProp = UrineDepth * Math.Pow(1.0, distFactor) / (distFactor + 1.0);\n                        depthFromSurface = 0.0;\n                        atZ1 = (UrineDepth - depthFromSurface) * Math.Pow(1.0 - depthFromSurface / UrineDepth, distFactor) / (distFactor + 1.0);\n                        for (int z = 0; z < layer+1; z++)\n                        {\n                            atZ0 = atZ1;\n                            depthFromSurface += soilPhysical.Thickness[z];\n                            atZ1 = (UrineDepth - depthFromSurface) * Math.Pow(1.0 - depthFromSurface / UrineDepth, distFactor) / (distFactor + 1);\n                            if (1.0 - (depthFromSurface / UrineDepth) < 0.0)\n                                atZ1 = 0;\n                            urineFraction[z] = (atZ0 - atZ1) / totalProp;\n                        }\n                        layer = soilPhysical.Thickness.Length;\n                    }\n                }\n            }\n\n            // write message in summary\n            mySummary.WriteMessage(this,\" Automatic defoliation manager initialised\");\n            if (AutomaticManagementIsEnabled)\n            {\n                mySummary.WriteMessage(this, \"   Defoliations will happen between \" + DefoliationRotationStartDate.ToShortDateString()\n                                          + \" and \" + DefoliationRotationEndDate.ToShortDateString() + \".\");\n                mySummary.WriteMessage(this, \"   Biomass from the sward will be defoliated simulating a \\\"\" + baseDefoliationType + \"\\\" rotation.\");\n                if (DefoliationTriggerType == DefoliationTriggerTypes.TargetStandingBiomass)\n                    mySummary.WriteMessage(this, \"   Events will happen whenever aboveground biomass surpasses \" + TargetStandingBiomass.ToString(\"#0.0\") + \" g/m2.\");\n                else\n                    mySummary.WriteMessage(this, \"   Events will happen every \" + IntervalBetweenDefoliations + \" days, if there is enough biomass.\");\n                if(baseAmountType == \"ResidualDM\")\n                    mySummary.WriteMessage(this, \"   Removing biomass down to a residual amount of \" + AmountForEachDefoliation.ToString(\"#.0\") + \" g/m2 over \" \n                                             + DurationOfEachDefoliation + \" days.\");\n                else\n                    mySummary.WriteMessage(this, \"   Removing \" + AmountForEachDefoliation.ToString(\"#.0\") + \" g/m2 of biomass per day over \" \n                                             + DurationOfEachDefoliation + \" days.\");\n            }\n            else\n            {\n                mySummary.WriteMessage(this,\"   Automatic defoliations are currently disabled, though defoliations can be triggered by another manager\");\n                mySummary.WriteMessage(this,\"   If called, the manager will remove biomass from the sward simulating a \\\"\" + baseDefoliationType + \"\\\" event.\");\n            }\n\n            if(ReturnType == ReturnAsTypes.AsDungUrine)\n            {\n                mySummary.WriteMessage(this,\"   Non-removed material will be returned as dung and urine. Urine added to soil according to proportions: \"\n                + string.Join(\", \",urineFraction));\n            }\n            else\n                mySummary.WriteMessage(this,\"   Non-removed material will be returned as residue.\");\n        }\n\n        [EventSubscribe(\"DoManagement\")]\n        private void OnDoManagement(object sender, EventArgs e)\n        {\n            // check whether we need to continue defoliationg, i.e. within a multi-day defoliation event (need to check this first in the day)\n            if ((daysDefoliating > 0) && (daysDefoliating < durationOfDefoliation))\n            {\n                // reset outputs\n                resetMyOutputs();\n\n                // re-check the amount to defoliate\n                double harvestableBiomass = harvestableSwardBiomass(\"All\", \"Harvestable\");\n                if (typeOfAmount == \"DMToRemove\")\n                {\n                    if(harvestableBiomass > 0.001)\n                        herbageToRemove = Math.Min(harvestableBiomass, (amountGiven - cumAmountHarvested) / (durationOfDefoliation - daysDefoliating));\n                }\n                else if (typeOfAmount == \"ResidualDM\")\n                {\n                    double currentDM = standingSwardBiomassWt;\n                    if (currentDM > amountGiven)\n                        herbageToRemove = Math.Min(harvestableBiomass, (currentDM - amountGiven) / (durationOfDefoliation - daysDefoliating));\n                }\n\n                // remove plant biomass and return residue\n                if (Math.Abs(herbageToRemove) >= 0.001)\n                {\n                    // set biomass removal\nmySummary.WriteMessage(this, \"   Defoliation initialised on DoManagement - \" + clock.Today.Date.ToShortDateString());\n                    defoliateSward(herbageToRemove, typeOfDefoliation);\n\n                    // return residue or excreta\n                    if(ReturnedWt + ReturnedN > 0.0)\n                    {\n                        if (ReturnType == ReturnAsTypes.AsResidue)\n                            returnResidues();\n                        else\n                            returnExcreta();\n                    }\n\n                    // gather amount removed this event\n                    cumAmountHarvested += HarvestedWt;\n                }\n\n                daysDefoliating += 1;\n            }\n\n            // check whether a defoliation ended yesterday\n            if (daysDefoliating < 0)\n            { // clean up variables\n                resetMyOutputs();\n                daysDefoliating = 0;\n            }\n\n            // check whether automatic defoliations are enabled\n            if (AutomaticManagementIsEnabled)\n            {\n                // check whether we are within the period in which defoliations can happen\n                if ((clock.Today.Date >= DefoliationRotationStartDate.Date) && (clock.Today.Date <= DefoliationRotationEndDate.Date))\n                {\n                    if (clock.Today.Date == DefoliationRotationStartDate.Date)\n                        DaysSinceLastDefoliation = IntervalBetweenDefoliations;\n\n                    // check whether we should start a defoliation event\n                    if (DefoliationTriggerType == DefoliationTriggerTypes.FixedInterval)\n                    {\n                        if (DaysSinceLastDefoliation == IntervalBetweenDefoliations)\n                            Defoliate(baseDefoliationType, AmountForEachDefoliation, baseAmountType, DurationOfEachDefoliation);\n                    }\n                    else if (DefoliationTriggerType == DefoliationTriggerTypes.TargetInterval)\n                    {\n                        if (DaysSinceLastDefoliation >= IntervalBetweenDefoliations)\n                            Defoliate(baseDefoliationType, AmountForEachDefoliation, baseAmountType, DurationOfEachDefoliation);\n                    }\n                    else  //DefoliationTriggerType == DefoliationTriggerTypes.TargetStandingBiomass\n                    {\n                        if (standingSwardBiomassWt >= TargetStandingBiomass)\n                            Defoliate(baseDefoliationType, AmountForEachDefoliation, baseAmountType, DurationOfEachDefoliation);\n                    }\n                }\n                //// Note: Only the code above, responsible for triggering automatic events, is limited by 'AutomaticManagementIsEnabled'. \n                ////       The rest of the code is still available to perform one-off defoliations.\n                ////       It can be called from another manager or a schedulle thingy via Defoliate().\n            }\n        }\n\n        [EventSubscribe(\"DoManagementCalculations\")]\n        private void OnDoManagementCalculations(object sender, EventArgs e)\n        {\n            // check whether a defoliation event has just been completed\n            if (daysDefoliating == durationOfDefoliation)\n            {\n                // get amount of biomass remaining and zero counters\n                PostHarvestDM = standingSwardBiomassWt;\n                RotationHarvestedDM = cumAmountHarvested;\n                aDefoliationHasHappened = true;\n                daysDefoliating = -1;\n            }\n\n            // count the days after a defoliation\n            if (aDefoliationHasHappened && (daysDefoliating == 0))\n                DaysSinceLastDefoliation += 1;\n        }\n\n        /// <summary>Sets up a defoliation event.</summary>\n        /// <param name=\"defoliationType\">Type of defoliation (cut, graze, or harvest)</param>\n        /// <param name=\"amountDM\">Amount of biomass to use (g/m2)</param>\n        /// <param name=\"amountType\">How the DM amount is interpreted (toRemove, residual)</param>\n        /// <param name=\"duration\">Number of days to defoliate over</param>\n        public void Defoliate(string defoliationType, double amountDM, string amountType, int duration)\n        {\n            // check whether there are plants in the sward that can be defoliated\n            if (swardHasLivingPlants)\n            {\n                // check the defoliation type\n                if (defoliationType.ToLower() == \"cut\")\n                    typeOfDefoliation = \"Cut\";\n                else if (defoliationType.ToLower() == \"graze\")\n                    typeOfDefoliation = \"Graze\";\n                else if (defoliationType.ToLower() == \"harvest\")\n                    typeOfDefoliation = \"Harvest\";\n                else\n                    throw new Exception(\"Defoliation type should be either \\\"Cut\\\", \\\"Graze\\\", or \\\"Harvest\\\"!\");\n\n                // check DM amount given\n                if (amountDM < 0.0)\n                    throw new Exception(\"Amount to defoliate cannot be negative!\");\n                else\n                    amountGiven = amountDM;\n\n                // check the type of amount given\n                if (amountType.ToLower() == \"dmtoremove\")\n                    typeOfAmount = \"DMToRemove\";\n                else if (amountType.ToLower() == \"residualdm\")\n                    typeOfAmount = \"ResidualDM\";\n                else if (amountType.ToLower() == \"usedefoliationfractions\")\n                    typeOfAmount = \"UseDefoliationFractions\";\n                else\n                    throw new Exception(\"Amount type should be \\\"DMToRemove\\\", \\\"ResidualDM\\\", or \\\"UseDefoliationFractions\\\"!\");\n\n                // check duration given\n                if (duration <= 0)\n                    throw new Exception(\"Duration of defoliation cannot be zero or negative!\");\n                else\n                    durationOfDefoliation = duration;\n\n                // check existing biomass and amount to remove\n                PreHarvestDM = standingSwardBiomassWt;\n                herbageToRemove = 0.0;\n                double harvestableBiomass = harvestableSwardBiomass(\"All\", \"Harvestable\");\n                if (typeOfAmount == \"UseDefoliationFractions\")\n                { // amount given is ignored, removal based on fractions\n                    amountGiven = 0.0;\n                    if (harvestableBiomass > 0.0)\n                        herbageToRemove = -1.0;\n\n                    mySummary.WriteMessage(this, \"   Defoliation triggered, removing biomass using the removal fractions (set or default), during \" + durationOfDefoliation + \" days\");\n                }\n                else if (typeOfAmount == \"DMToRemove\")\n                {\n                    if (amountGiven > 0.001)\n                    { // a meaningful amount was given, check whether all can be removed\n                        if (harvestableBiomass > 0.001)\n                            herbageToRemove = Math.Min(harvestableBiomass, amountGiven / durationOfDefoliation);\n\n                        mySummary.WriteMessage(this, \"   Defoliation triggered, attempting to remove \" + amountGiven.ToString(\"#0.0\") + \" g/m2 of biomass over \" + durationOfDefoliation + \" days\");\n                    }\n                }\n                else if (typeOfAmount == \"ResidualDM\")\n                {\n                    // check how much biomass will be removed\n                    if (PreHarvestDM > amountGiven)\n                        herbageToRemove = Math.Min(harvestableBiomass, (PreHarvestDM - amountGiven) / durationOfDefoliation);\n\n                    mySummary.WriteMessage(this, \"   Defoliation triggered, attempting to remove biomass down to \" + amountGiven.ToString(\"#0.0\") + \" g/m2 over \" + durationOfDefoliation + \" days\");\n                }\n\n                // can defoliation begin?\n                if (Math.Abs(herbageToRemove) >= 0.001)\n                {\n                    // set off first defoliation\nmySummary.WriteMessage(this, \"   Defoliation initialised on Defoliate - \" + clock.Today.Date.ToShortDateString());\n                    defoliateSward(herbageToRemove, typeOfDefoliation);\n\n                    // return residue or excreta\n                    if(ReturnedWt + ReturnedN > 0.0)\n                    {\n                        if (ReturnType == ReturnAsTypes.AsResidue)\n                            returnResidues();\n                        else\n                            returnExcreta();\n                    }\n\n                    // gather values for this event\n                    cumAmountHarvested = HarvestedWt;\n                    daysDefoliating = 1;\n                    DaysSinceLastDefoliation = 0;\n                }\n                else\n                {\n                    // abort command as there is not enough biomass, check interval type\n                    if (DefoliationTriggerType == DefoliationTriggerTypes.FixedInterval)\n                    { // count the event as if it did happen\n                        cumAmountHarvested = 0.0;\n                        daysDefoliating = 1;\n                        DaysSinceLastDefoliation = 0;\n                    }\n\n                    mySummary.WriteMessage(this, \"   Defoliation did not happend because current biomass (\" + PreHarvestDM.ToString(\"#0.0\") + \" g/m2) is too low (total harvestable = \" + harvestableBiomass.ToString(\"#0.0\") + \" g/m2)\");\n                }\n            }\n            else\n            {\n                mySummary.WriteMessage(this, \"   Defoliation did not happend because there is no growing plants in the sward\");\n            }\n        }\n\n        /// <summary>Resets the values of outputs.</summary>\n        private void resetMyOutputs()\n        {\n            DefoliatedWt = 0.0;\n            DefoliatedN = 0.0;\n            HarvestedWt = 0.0;\n            HarvestedN = 0.0;\n            RemovedWt = 0.0;\n            RemovedN = 0.0;\n            ReturnedWt = 0.0;\n            ReturnedN = 0.0;\n            NReturnedInDung = 0.0;\n            NReturnedInUrine = 0.0;\n            RotationHarvestedDM = 0.0;\n        }\n\n        /// <summary>Flags whether there is any living plant in the sward.</summary>\n        private bool swardHasLivingPlants\n        {\n            get\n            {\n                bool result = false;\n                foreach (Plant species in PMFSpecies)\n                       result |= species.IsAlive;\n                foreach (AgPasture.PastureSpecies species in AgPSpecies)\n                       result |= species.IsAlive;\n                return result;\n            }\n        }\n\n        /// <summary>Amount of plant biomass aboveground (g/m2).</summary>\n        private double standingSwardBiomassWt\n        {\n            get\n            {\n                double result = 0.0;\n                foreach (Plant species in PMFSpecies)\n                   result += (double)myZone.Get(species.Name+\".AboveGround.Wt\");\n                foreach (AgPasture.PastureSpecies species in AgPSpecies)\n                    result += species.Standing.Wt*0.1;\n                return result;\n            }\n        }\n\n        /// <summary>Amount of N in plant's biomass aboveground (g/m2).</summary>\n        private double standingSwardBiomassN\n        {\n            get\n            {\n                double result = 0.0;\n                foreach (Plant species in PMFSpecies)\n                   result += (double)myZone.Get(species.Name+\".AboveGround.N\");\n                foreach (AgPasture.PastureSpecies species in AgPSpecies)\n                    result += species.Standing.N*0.1;\n                return result;\n            }\n        }\n\n        /// <summary>Amount of plant biomass from all organs available for defoliation (g/m2).</summary>\n        /// <remarks>Assumes that organs with a BiomassRemoval.FractionToRemove > 0 are harvestable.\n        /// For AgPasture, harvestable is based on minimum DM.</remarks>\n        /// <param name=\"plantName\">The name of the plant to retrieve its biomass</param>\n        /// <param name=\"fractionType\">The type of fraction to use (harvestable or total)</param>\n        private double harvestableSwardBiomass(string plantName, string fractionType)\n        {\n            double amountWt = 0.0;\n            double fraction = 0.0;\n            foreach (Plant species in PMFSpecies)\n            {\n                if ((plantName == \"All\") || (species.Name == plantName))\n                {\n                    if (species.AboveGround.Wt > 0.0)\n                    {\n                        foreach (IOrgan organ in species.FindAllChildren<IOrgan>().OfType<IModel>().ToList())\n                        { // consider only amounts toRemove\n                            fraction = (double)myZone.Get(species.Name + \".\" + organ.Name + \".BiomassRemovalDefaults.\" + typeOfDefoliation + \".FractionLiveToRemove\");\n                            if ((fractionType == \"Total\") && (fraction > 0.0))\n                                fraction = 1.0;\n                            else if (RemoveAllBiomassIsEnabled && (fraction > 0.0))\n                                fraction = 0.95;\n                            amountWt += (double)myZone.Get(species.Name + \".\" + organ.Name + \".Live.Wt\") * fraction;\n                            fraction = (double)myZone.Get(species.Name + \".\" + organ.Name + \".BiomassRemovalDefaults.\" + typeOfDefoliation + \".FractionDeadToRemove\");\n                            if ((fractionType == \"Total\") && (fraction > 0.0))\n                                fraction = 1.0;\n                            else if (RemoveAllBiomassIsEnabled && (fraction > 0.0))\n                                fraction = 0.95;\n                            amountWt += (double)myZone.Get(species.Name + \".\" + organ.Name + \".Dead.Wt\") * fraction;\n                        }\n                    }\n                }\n            }\n\n            foreach (AgPasture.PastureSpecies species in AgPSpecies)\n            {\n                if ((plantName == \"All\") || (species.Name == plantName))\n                {\n                    if (fractionType == \"Total\")\n                        amountWt += species.AboveGroundWt*0.1;\n                    else\n                        amountWt += species.Harvestable.Wt*0.1;\n                }\n            }\n\n            return amountWt;\n        }\n\n        /// <summary>Triggers the actual biomass removal and gather DM and N amounts.</summary>\n        /// <param name=\"amountToRemove\">The total DM amount to remove (g/m2)</param>\n        /// <param name=\"removalType\">The type of removal (Cut, Graze, Harvest)</param>\n        private void defoliateSward(double amountToRemove, string removalType)\n        {\n            // get the amounts of biomass and N before today's defoliation\n            double preRemovalDM = standingSwardBiomassWt;\n            double preRemovalN = standingSwardBiomassN;\n            double fractionToRemove = 0.0;\n\n            // gather the actual biomass removal fractions, checking whether they need to be adjusted\n            double totalHarvestableAmount = harvestableSwardBiomass(\"All\", \"Harvestable\");\n            if (amountToRemove > 0.0)\n            { // an amount was given for defoliation, adjust removal fractions for each species in order to remove the amount specified\n                fractionToRemove = amountToRemove / totalHarvestableAmount;\n            }\n            else if (amountToRemove < 0.0)\n            { // defoliation is not based on an amount, removal is determined simply by the removal fractions\n                fractionToRemove = 1.0;\n            }\n\n            for (int i = 0; i < swardSpeciesName.Length; i++)\n            {\n                speciesFraction[i] = harvestableSwardBiomass(swardSpeciesName[i], \"Harvestable\") / totalHarvestableAmount;\n                if (swardSpeciesType[i] == \"PMF\")\n                {\n                    // check whether the plant is alive\n                    bool speciesIsAlive = (bool)myZone.Get(swardSpeciesName[i]+\".IsEmerged\");\n                    if (speciesIsAlive)\n                    {\n                        // set removal fractions (these overrides the default removals in the plant)\n                        setRemoveFraction(swardSpeciesName[i], fractionToRemove);\n\n                        // do the actual biomass removal\n                        foreach (Plant species in PMFSpecies)\n                        {\n                            if(species.Name == swardSpeciesName[i])\n                            {\n                                species.RemoveBiomass(removalType, defoliationFractions);\n                                break;\n                            }\n                        }\n                    }\n                }\n                else\n                {\n                    // check whether the plant is alive\n                    bool speciesIsAlive = (bool)myZone.Get(swardSpeciesName[i]+\".IsAlive\");\n                    if (speciesIsAlive)\n                    {\n                        // set removal amount (needs to be in kg/ha)\n                        double amountRequired = (double)myZone.Get(swardSpeciesName[i]+\".Harvestable.Wt\");\n                        if (amountToRemove > 0.0)\n                            amountRequired = amountToRemove * speciesFraction[i] * 10.0;\n\n                        // do the actual biomass removal\n                        foreach (AgPasture.PastureSpecies species in AgPSpecies)\n                        {\n                            if(species.Name == swardSpeciesName[i])\n                            {\n                                species.RemoveBiomass(amount: amountRequired, type: \"SetRemoveAmount\");\n                                break;\n                            }\n                        }\n                    }\n                }\n            }\n\n            // get the amounts of biomass and N after today's defoliation\n            double postRemovalDM = standingSwardBiomassWt;\n            double postRemovalN = standingSwardBiomassN;\n\n            // get total defoliation (total plant stuff lost)\n            DefoliatedWt = preRemovalDM - postRemovalDM;\n            DefoliatedN = preRemovalN - postRemovalN;\n\n            // get amounts harvested, removed, and returned\n            manageDefoliatedBiomass();\n        }\n\n        /// <summary>Sets the biomass removal fractions for PMF plants.</summary>\n        /// <param name=\"plantName\">The name of PMF species</param>\n        /// <param name=\"fractionHarvestable\">The fraction of harvestable biomass to be removed (0-1)</param>\n        private void setRemoveFraction(string plantName, double fractionHarvestable)\n        {\n            foreach (Plant species in PMFSpecies)\n            {\n                if ((species.Name == plantName) && (species.IsAlive))\n                {\n\n                    // set removal fractions (these overrides the default removals in the plant)\n                    foreach (IOrgan organ in species.FindAllChildren<IOrgan>().OfType<IModel>().ToList())\n                    {\n                        // first get the removal for Live material\n                        fractionToRemove = (double)myZone.Get(species.Name + \".\" + organ.Name + \".BiomassRemovalDefaults.\" + typeOfDefoliation + \".FractionLiveToRemove\");\n                        if (RemoveAllBiomassIsEnabled && (fractionToRemove > 0.0))\n                            fractionToRemove = 0.95;\n                        fractionToRemove = fractionHarvestable * fractionToRemove;\n                        fractionToRemove = Math.Min(1.0, fractionToRemove);\n                        defoliationFractions.SetFractionToRemove(organ.Name, fractionToRemove, \"Live\");\n                        if (RemoveAllBiomassIsEnabled)\n                            fractionToResidue = 0.0;\n                        else\n                            fractionToResidue = (double)myZone.Get(species.Name + \".\" + organ.Name + \".BiomassRemovalDefaults.\" + typeOfDefoliation + \".FractionLiveToResidue\");\n                        fractionToResidue = Math.Min(fractionHarvestable * fractionToResidue, 1.0 - fractionToRemove);\n                        defoliationFractions.SetFractionToResidue(organ.Name, fractionToResidue, \"Live\");\n\n                        // then get the removal for Dead material\n                        fractionToRemove = (double)myZone.Get(species.Name + \".\" + organ.Name + \".BiomassRemovalDefaults.\" + typeOfDefoliation + \".FractionDeadToRemove\");\n                        if (RemoveAllBiomassIsEnabled && (fractionToRemove > 0.0))\n                            fractionToRemove = 0.95;\n                        fractionToRemove = fractionHarvestable * fractionToRemove;\n                        fractionToRemove = Math.Min(1.0, fractionToRemove);\n                        defoliationFractions.SetFractionToRemove(organ.Name, fractionToRemove, \"Dead\");\n                        if (RemoveAllBiomassIsEnabled)\n                            fractionToResidue = 0.0;\n                        else\n                            fractionToResidue = (double)myZone.Get(species.Name + \".\" + organ.Name + \".BiomassRemovalDefaults.\" + typeOfDefoliation + \".FractionDeadToResidue\");\n                        fractionToResidue = Math.Min(fractionHarvestable * fractionToResidue, 1.0 - fractionToRemove);\n                        defoliationFractions.SetFractionToResidue(organ.Name, fractionToResidue, \"Dead\");\n                    }\n                }\n            }\n        }\n\n        /// <summary>Gathers the DM and N amounts harvested, to be removed, and to be returned.</summary>\n        private void manageDefoliatedBiomass()\n        {\n            double digestibilityStructural = 0.65;\n            double digestibilityNonStrucutural = 1.0;\n\n            if (DefoliatedWt > 0.0)\n            {\n                HarvestedWt = 0.0;\n                HarvestedN = 0.0;\n                RemovedWt = 0.0;\n                RemovedN = 0.0;\n\n                foreach (Plant species in PMFSpecies)\n                {\n                    if(species.AboveGround.Wt > 0.0)\n                    {\n                        // get the amount harvested (plant stuff removed from plants)\n                        speciesHarvestedWt = 0.0;\n                        speciesHarvestedN = 0.0;\n                        foreach (IOrgan organ in species.FindAllChildren<IOrgan>().OfType<IModel>().ToList())\n                        {\n                            speciesHarvestedWt += (double)myZone.Get(species.Name+\".\"+organ.Name+\".Removed.Wt\");\n                            speciesHarvestedN += (double)myZone.Get(species.Name+\".\"+organ.Name+\".Removed.N\");\n                        }\n\n                        HarvestedWt += speciesHarvestedWt;\n                        HarvestedN += speciesHarvestedN;\n\n                        // get the DM fraction to be removed\n                        if(FractionDMToRemove>=0.0)\n                        {\n                            speciesFractionToRemove = FractionDMToRemove;\n                        }\n                        else\n                        { // use digestibility to define the fraction\n                            double fracStructural = species.AboveGround.StructuralWt/species.AboveGround.Wt;\n                            speciesFractionToRemove = (1.0 - fracStructural)*digestibilityNonStrucutural + fracStructural*digestibilityStructural;\n                            speciesFractionToRemove = Math.Min(1.0, Math.Max(0.0, speciesFractionToRemove));\n                        }\n\n                        // get the amounts actually removed from field\n                        RemovedWt += speciesHarvestedWt * speciesFractionToRemove;\n                        RemovedN += speciesHarvestedN * FractionNToRemove;\n                   }\n                }\n\n                foreach (AgPasture.PastureSpecies species in AgPSpecies)\n                {\n                    if(species.AboveGroundWt > 0.0)\n                    {\n                        // get the amount harvested\n                        speciesHarvestedWt = species.HarvestedWt*0.1;\n                        speciesHarvestedN = species.HarvestedN*0.1;\n                        HarvestedWt += speciesHarvestedWt;\n                        HarvestedN += speciesHarvestedN;\n\n                        // get fraction to be removed\n                        if(FractionDMToRemove>=0.0)\n                        {\n                            speciesFractionToRemove = FractionDMToRemove;\n                        }\n                        else\n                        { // use digestibility to define the fraction\n                            speciesFractionToRemove = species.HarvestedDigestibility;\n                        }\n\n                        // get the amounts actually removed from field\n                        RemovedWt += speciesHarvestedWt * speciesFractionToRemove;\n                        RemovedN += speciesHarvestedN * FractionNToRemove;\n                    }\n                }\n\n                // get the amounts to be returned to the field (as residue or dung+urine)\n                ReturnedWt = HarvestedWt - RemovedWt;\n                ReturnedN = HarvestedN - RemovedN;\n                if (ReturnType == ReturnAsTypes.AsDungUrine)\n                {\n                    if (NDungType == DungNContentTypes.DefineProportion)\n                        NReturnedInDung = ReturnedN * ProportionN2Dung;\n                    else\n                        NReturnedInDung = Math.Min(ReturnedN, ReturnedWt * 0.4 / CNRatioDung);\n                    NReturnedInDung = Math.Min(NReturnedInDung, ReturnedN);\n                    NReturnedInUrine = ReturnedN - NReturnedInDung;\n                }\n                else\n                {\n                    NReturnedInDung = 0.0;\n                    NReturnedInUrine = 0.0;\n                }\n            }\n        }\n\n        /// <summary>Returns the material not removed off field as residue.</summary>\n        private void returnResidues()\n        {\n            if ((ReturnedWt > 0.0) || (ReturnedN > 0.0))\n            {\n                PMF.BiomassRemovedType BiomassResidue = new PMF.BiomassRemovedType();\n                string[] type = new string[] { \"Grass\" };\n                float[] dltdm = new float[] { (float)(10.0 * ReturnedWt) };\n                float[] dltn = new float[] { (float)(10.0 * ReturnedN) };\n                float[] dltp = new float[] { 0 };\n                float[] fraction = new float[] { 1 };     // fraction is always 1.0 here\n\n                BiomassResidue.crop_type = \"Grass\";\n                BiomassResidue.dm_type = type;\n                BiomassResidue.dlt_crop_dm = dltdm;\n                BiomassResidue.dlt_dm_n = dltn;\n                BiomassResidue.dlt_dm_p = dltp;\n                BiomassResidue.fraction_to_residue = fraction;\n                BiomassRemoved.Invoke(BiomassResidue);\n            }\n        }\n\n        /// <summary>Returns the material not removed off field as dung and urine).</summary>\n        private void returnExcreta()\n        {\n            if ((ReturnedWt > 0.0) || (NReturnedInDung > 0.0))\n            {\n                PMF.BiomassRemovedType BiomassDung = new PMF.BiomassRemovedType();\n                string[] type = new string[] { \"RuminantDung_PastureFed\" };\n                float[] dltdm = new float[] { (float)(10.0 * ReturnedWt) };\n                float[] dltn = new float[] { (float)(10.0 * NReturnedInDung) };\n                float[] dltp = new float[] { 0 };\n                float[] fraction = new float[] { 1 };     // fraction is always 1.0 here\n\n                BiomassDung.crop_type = \"RuminantDung_PastureFed\";\n                BiomassDung.dm_type = type;\n                BiomassDung.dlt_crop_dm = dltdm;\n                BiomassDung.dlt_dm_n = dltn;\n                BiomassDung.dlt_dm_p = dltp;\n                BiomassDung.fraction_to_residue = fraction;\n                BiomassRemoved.Invoke(BiomassDung);\n            }\n\n            if (NReturnedInUrine > 0.0)\n            {\n                double[] myUrineDeposition = new double[soilPhysical.Thickness.Length];\n                for (int z = 0; z < urineFraction.Length; z++)\n                    myUrineDeposition[z] = NReturnedInUrine * 10.0 * urineFraction[z];\n                Urea.AddKgHaDelta(SoluteSetterType.Fertiliser, myUrineDeposition);\n            }\n        }\n\n        // Auxiliary bits and pieces  - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n        /// <summary>Type of defoliation to use</summary>\n        public enum DefoliationTypes\n        {\n            /// <summary>Cut</summary>\n            Cut,\n            /// <summary>Graze</summary>\n            Graze,\n            /// <summary>Harvest</summary>\n            Harvest\n        }\n\n        /// <summary>Flag how defoliations will be triggered</summary>\n        public enum DefoliationTriggerTypes\n        {\n            /// <summary>Setting a fixed interval</summary>\n            FixedInterval,\n            /// <summary>Setting a target (minimum) inteval</summary>\n            TargetInterval,\n            /// <summary>Setting a target (maximum) standing biomass</summary>\n            TargetStandingBiomass\n        }\n\n        /// <summary>How the DM amount given is interpreted</summary>\n        public enum DefoliateAmountTypes\n        {\n            /// <summary>Setting a DM amount to remove</summary>\n            DMToRemove,\n            /// <summary>Setting the residual DM amount</summary>\n            ResidualDM,\n            /// <summary>Remove according to crop's BiomassRemovalFractions</summary>\n            None_UseDefoliationFractions\n        }\n\n        /// <summary>Fraction of defoliated DM to remove from field</summary>\n        public enum DMRemovalTypes\n        {\n            /// <summary>Remove all DM</summary>\n            RemoveAll,\n            /// <summary>Remove no DM</summary>\n            RemoveNone,\n            /// <summary>Remove a user-defined fraction</summary>\n            UserDefinedFraction,\n            /// <summary>Remove a fraction based on plant digestibility</summary>\n            BasedOnDigestibility\n        }\n\n        /// <summary>Fraction of N in the defoliated material to remove from field</summary>\n        public enum NRemovalTypes\n        {\n            /// <summary>Remove all N</summary>\n            RemoveAll,\n            /// <summary>Remove no N</summary>\n            RemoveNone,\n            /// <summary>Remove a user-defined fraction</summary>\n            UserDefinedFraction,\n            /// <summary>Remove a fraction equal to DM removed</summary>\n            ProportionalToDM\n        }\n\n        /// <summary>Define how the non-removed material is returned to the field</summary>\n        public enum ReturnAsTypes\n        {\n            /// <summary>Return plant material as residue</summary>\n            AsResidue,\n            /// <summary>Return meterial as dung and urine</summary>\n            AsDungUrine\n        }\n\n        /// <summary>Define how the proportion of N in dung is defined</summary>\n        public enum DungNContentTypes\n        {\n            /// <summary>Define the proportion of N returned as dung</summary>\n            DefineProportion,\n            /// <summary>Define the C:N of dung</summary>\n            DefineCNratio\n        }\n    }\n}\n",
                  "Parameters": [
                    {
                      "Key": "AutomaticManagementIsEnabled",
                      "Value": "False"
                    },
                    {
                      "Key": "DefoliationRotationStartDate",
                      "Value": "01/15/2000 00:00:00"
                    },
                    {
                      "Key": "DefoliationRotationEndDate",
                      "Value": "12/31/2100 00:00:00"
                    },
                    {
                      "Key": "DefoliateType",
                      "Value": "Graze"
                    },
                    {
                      "Key": "DefoliationTriggerType",
                      "Value": "FixedInterval"
                    },
                    {
                      "Key": "IntervalBetweenDefoliations",
                      "Value": "21"
                    },
                    {
                      "Key": "TargetStandingBiomass",
                      "Value": "200"
                    },
                    {
                      "Key": "DurationOfEachDefoliation",
                      "Value": "1"
                    },
                    {
                      "Key": "RemoveAmountType",
                      "Value": "DMToRemove"
                    },
                    {
                      "Key": "AmountForEachDefoliation",
                      "Value": "500"
                    },
                    {
                      "Key": "RemoveAllBiomassIsEnabled",
                      "Value": "True"
                    },
                    {
                      "Key": "DMRemoveType",
                      "Value": "UserDefinedFraction"
                    },
                    {
                      "Key": "FractionDMToRemove",
                      "Value": "1"
                    },
                    {
                      "Key": "NRemoveType",
                      "Value": "UserDefinedFraction"
                    },
                    {
                      "Key": "FractionNToRemove",
                      "Value": "1"
                    },
                    {
                      "Key": "ReturnType",
                      "Value": "AsResidue"
                    },
                    {
                      "Key": "NDungType",
                      "Value": "DefineCNratio"
                    },
                    {
                      "Key": "ProportionN2Dung",
                      "Value": "0.4"
                    },
                    {
                      "Key": "CNRatioDung",
                      "Value": "20"
                    },
                    {
                      "Key": "UrineDepth",
                      "Value": "250"
                    }
                  ],
                  "Name": "DefoliationManager",
                  "IncludeInDocumentation": false,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Manager, Models",
                  "Code": "// This will be replaced by the \"ExtraVariables\" section in \"Replacements\"\n\nusing Models.Core;\nusing System;\n\nnamespace Models\n{\n    [Serializable] \n    public class Script : Model\n    {\n    }\n}\n",
                  "Parameters": [],
                  "Name": "ExtraVariables",
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                }
              ],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.MicroClimate, Models",
              "a_interception": 0.0,
              "b_interception": 1.0,
              "c_interception": 0.0,
              "d_interception": 0.0,
              "soil_albedo": 0.23,
              "SoilHeatFluxFraction": 0.4,
              "MinimumHeightDiffForNewLayer": 0.0,
              "NightInterceptionFraction": 0.5,
              "ReferenceHeight": 2.0,
              "Name": "MicroClimate",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Irrigation, Models",
              "Name": "Irrigation",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Fertiliser, Models",
              "ResourceName": "Fertiliser",
              "Name": "Fertiliser",
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Surface.SurfaceOrganicMatter, Models",
              "InitialResidueName": "grass",
              "InitialResidueType": "grass",
              "InitialResidueMass": 1000.0,
              "InitialStandingFraction": 0.0,
              "InitialCPR": 0.0,
              "InitialCNR": 30.0,
              "ResourceName": "SurfaceOrganicMatter",
              "Name": "SurfaceOrganicMatter",
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Soils.Soil, Models",
              "RecordNumber": 0,
              "ASCOrder": null,
              "ASCSubOrder": null,
              "SoilType": "Udic Haplustept (US),  Immature Pallic Soil (NZ)",
              "LocalName": "Paparua Deep Sandy Loam",
              "Site": "LURDF",
              "NearestTown": "Lincoln",
              "Region": "Canterbury",
              "State": null,
              "Country": "New Zealand",
              "NaturalVegetation": null,
              "ApsoilNumber": null,
              "Latitude": 0.0,
              "Longitude": 0.0,
              "LocationAccuracy": null,
              "YearOfSampling": null,
              "DataSource": "Adapted based on data from the NZ National Soils Database plus published data (Carey et al, 2002; Schwaertzel et al, 2011; Woods et al, 2016)",
              "Comments": "Different references name the soil at the site as either Templeton sandy loam or Paparua sandy loam (very similar soils)",
              "Name": "Soil",
              "Children": [
                {
                  "$type": "Models.Soils.Chemical, Models",
                  "Depth": [
                    "0-10",
                    "10-22",
                    "22-37",
                    "37-60",
                    "60-73",
                    "73-98",
                    "98-120",
                    "120-150"
                  ],
                  "Thickness": [
                    100.0,
                    120.0,
                    150.0,
                    230.0,
                    130.0,
                    250.0,
                    220.0,
                    300.0
                  ],
                  "NO3N": [
                    11.10185956147655,
                    8.8747914734271873,
                    4.0559509831354781,
                    0.36671947427096357,
                    0.3667194742709608,
                    0.15159344482840426,
                    0.072921934919511183,
                    0.066925445054209068
                  ],
                  "NH4N": [
                    1.3877324451845687,
                    1.0031235177747662,
                    0.42270867377952642,
                    0.07334389485419221,
                    0.073343894854192432,
                    0.054769866343026476,
                    0.017000511230675516,
                    0.013385089010841966
                  ],
                  "PH": [
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0,
                    6.0
                  ],
                  "CL": null,
                  "EC": null,
                  "ESP": null,
                  "ECMetadata": null,
                  "CLMetadata": null,
                  "ESPMetadata": null,
                  "PHMetadata": null,
                  "Name": "Chemical",
                  "Children": [],
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Soils.Physical, Models",
                  "Depth": [
                    "0-10",
                    "10-22",
                    "22-37",
                    "37-60",
                    "60-73",
                    "73-98",
                    "98-120",
                    "120-150"
                  ],
                  "Thickness": [
                    100.0,
                    120.0,
                    150.0,
                    230.0,
                    130.0,
                    250.0,
                    220.0,
                    300.0
                  ],
                  "ParticleSizeClay": [
                    17.8,
                    17.8,
                    15.9,
                    14.1,
                    7.3,
                    9.6,
                    7.0,
                    9.5
                  ],
                  "ParticleSizeSand": null,
                  "ParticleSizeSilt": null,
                  "Rocks": null,
                  "Texture": null,
                  "BD": [
                    1.154,
                    1.295,
                    1.441,
                    1.544,
                    1.505,
                    1.504,
                    1.517,
                    1.479
                  ],
                  "AirDry": [
                    0.051,
                    0.14,
                    0.129,
                    0.111,
                    0.08,
                    0.072,
                    0.085,
                    0.082
                  ],
                  "LL15": [
                    0.151,
                    0.146,
                    0.129,
                    0.111,
                    0.08,
                    0.072,
                    0.085,
                    0.082
                  ],
                  "DUL": [
                    0.338,
                    0.328,
                    0.279,
                    0.271,
                    0.244,
                    0.234,
                    0.254,
                    0.257
                  ],
                  "SAT": [
                    0.512,
                    0.469,
                    0.427,
                    0.394,
                    0.413,
                    0.406,
                    0.401,
                    0.413
                  ],
                  "KS": [
                    2559.2,
                    2142.3,
                    1019.5,
                    310.6,
                    434.9,
                    791.0,
                    744.1,
                    411.2
                  ],
                  "BDMetadata": null,
                  "AirDryMetadata": null,
                  "LL15Metadata": null,
                  "DULMetadata": null,
                  "SATMetadata": null,
                  "KSMetadata": null,
                  "RocksMetadata": null,
                  "TextureMetadata": null,
                  "ParticleSizeSandMetadata": null,
                  "ParticleSizeSiltMetadata": null,
                  "ParticleSizeClayMetadata": null,
                  "Name": "Physical",
                  "Children": [
                    {
                      "$type": "Models.Soils.SoilCrop, Models",
                      "LL": [
                        0.151,
                        0.146,
                        0.129,
                        0.111,
                        0.08,
                        0.072,
                        0.085,
                        0.082
                      ],
                      "KL": [
                        0.12,
                        0.11,
                        0.08,
                        0.05,
                        0.02,
                        0.005,
                        0.0,
                        0.0
                      ],
                      "XF": [
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0,
                        1.0
                      ],
                      "LLMetadata": null,
                      "KLMetadata": null,
                      "XFMetadata": null,
                      "Name": "RedCloverSoil",
                      "Children": [],
                      "IncludeInDocumentation": true,
                      "Enabled": true,
                      "ReadOnly": false
                    }
                  ],
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.WaterModel.WaterBalance, Models",
                  "SummerDate": "1-Oct",
                  "SummerU": 8.0,
                  "SummerCona": 4.0,
                  "WinterDate": "1-Apr",
                  "WinterU": 5.0,
                  "WinterCona": 1.5,
                  "DiffusConst": 88.0,
                  "DiffusSlope": 35.0,
                  "Salb": 0.2,
                  "CN2Bare": 60.0,
                  "CNRed": 20.0,
                  "CNCov": 0.8,
                  "DischargeWidth": 0.0,
                  "CatchmentArea": 0.0,
                  "Thickness": [
                    100.0,
                    120.0,
                    150.0,
                    230.0,
                    130.0,
                    250.0,
                    220.0,
                    300.0
                  ],
                  "SWCON": [
                    0.59,
                    0.59,
                    0.55,
                    0.48,
                    0.53,
                    0.5,
                    0.51,
                    0.45
                  ],
                  "KLAT": null,
                  "ResourceName": "WaterBalance",
                  "Name": "SoilWater",
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Soils.Organic, Models",
                  "Depth": [
                    "0-10",
                    "10-22",
                    "22-37",
                    "37-60",
                    "60-73",
                    "73-98",
                    "98-120",
                    "120-150"
                  ],
                  "FOMCNRatio": 35.0,
                  "Thickness": [
                    100.0,
                    120.0,
                    150.0,
                    230.0,
                    130.0,
                    250.0,
                    220.0,
                    300.0
                  ],
                  "Carbon": [
                    2.94,
                    2.17,
                    0.99,
                    0.35,
                    0.24,
                    0.2,
                    0.15,
                    0.1
                  ],
                  "SoilCNRatio": [
                    11.3,
                    11.3,
                    11.5,
                    11.75,
                    12.0,
                    12.25,
                    12.5,
                    12.5
                  ],
                  "FBiom": [
                    0.08,
                    0.055,
                    0.015,
                    0.009,
                    0.008,
                    0.007,
                    0.005,
                    0.005
                  ],
                  "FInert": [
                    0.3,
                    0.45,
                    0.72,
                    0.87,
                    0.95,
                    0.99,
                    0.995,
                    0.995
                  ],
                  "FOM": [
                    450.0,
                    412.5,
                    322.5,
                    150.0,
                    75.0,
                    45.0,
                    30.0,
                    15.0
                  ],
                  "CarbonMetadata": null,
                  "FOMMetadata": null,
                  "Name": "Organic",
                  "Children": [],
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Soils.CERESSoilTemperature, Models",
                  "Name": "Temperature",
                  "Children": [],
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Soils.InitialWater, Models",
                  "PercentMethod": 1,
                  "FractionFull": 0.75,
                  "DepthWetSoil": "NaN",
                  "RelativeTo": null,
                  "Name": "Initial water",
                  "Children": [],
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                },
                {
                  "$type": "Models.Soils.Nutrients.Nutrient, Models",
                  "ResourceName": "Nutrient",
                  "Name": "Nutrient",
                  "IncludeInDocumentation": true,
                  "Enabled": true,
                  "ReadOnly": false
                }
              ],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.PMF.Plant, Models",
              "ResourceName": "RedClover",
              "Name": "RedClover",
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Report, Models",
              "VariableNames": [
                "[Clock].Today as Date",
                "",
                "[RedClover].Population",
                "[RedClover].PlantType",
                "[RedClover].Leaf.RadiationIntercepted as InterceptedRadiation",
                "",
                "[Irrigation].IrrigationApplied as IrrigationApplied",
                "[Soil].SoilWater.Es as Evaporation",
                "[RedClover].Leaf.Transpiration as Transpiration",
                "[Soil].SoilWater.Drainage as Drainage",
                "[Soil].SoilWater.Runoff as Runoff",
                "sum([Soil].SoilWater.SWmm) as TotalSWC",
                "sum([Soil].Physical.DULmm) as TotalDUL",
                "sum([Soil].Physical.LL15mm) as TotalLL15",
                "[Fertiliser].NitrogenApplied as FertiliserN",
                "([Soil].SoilWater.LeachNH4 + [Soil].SoilWater.LeachNO3) as LeachedN",
                "(-1*[RedClover].Root.NUptake) as UptakeN",
                "[RedClover].Nodule.NFixed as FixedN",
                "",
                "[RedClover].Total.Wt",
                "[RedClover].AboveGround.Wt",
                "[RedClover].BelowGround.Wt",
                "[RedClover].Leaf.Live.NConc",
                "[RedClover].Leaf.LAI",
                "[RedClover].Leaf.Live.Wt",
                "[RedClover].Stem.Live.Wt",
                "[RedClover].Inflorescence.Live.Wt",
                "[RedClover].Taproot.Live.Wt",
                "[RedClover].Root.Live.Wt",
                "",
                "[DefoliationManager].Script.DefoliatedWt as HarvestedWt"
              ],
              "EventNames": [
                "[Clock].DoReport"
              ],
              "GroupByVariableName": null,
              "Name": "Report",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            }
          ],
          "IncludeInDocumentation": true,
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Graph, Models",
          "Caption": null,
          "Axis": [
            {
              "$type": "Models.Axis, Models",
              "Type": 3,
              "Title": "Date",
              "Inverted": false,
              "Minimum": "NaN",
              "Maximum": "NaN",
              "Interval": "NaN",
              "DateTimeAxis": false,
              "CrossesAtZero": false
            },
            {
              "$type": "Models.Axis, Models",
              "Type": 0,
              "Title": null,
              "Inverted": false,
              "Minimum": "NaN",
              "Maximum": "NaN",
              "Interval": "NaN",
              "DateTimeAxis": false,
              "CrossesAtZero": false
            }
          ],
          "LegendPosition": 0,
          "LegendOrientation": 0,
          "AnnotationPosition": 0,
          "DisabledSeries": [],
          "LegendOutsideGraph": false,
          "Name": "Biomass",
          "Children": [
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -16777216,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 1,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "RedClover.Total.Wt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Total",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -16736653,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "RedClover.AboveGround.Wt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "AboveGround",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -2793984,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "RedClover.BelowGround.Wt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "BelowGround",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            }
          ],
          "IncludeInDocumentation": true,
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Graph, Models",
          "Caption": null,
          "Axis": [
            {
              "$type": "Models.Axis, Models",
              "Type": 3,
              "Title": "Date",
              "Inverted": false,
              "Minimum": "NaN",
              "Maximum": "NaN",
              "Interval": "NaN",
              "DateTimeAxis": false,
              "CrossesAtZero": false
            },
            {
              "$type": "Models.Axis, Models",
              "Type": 0,
              "Title": null,
              "Inverted": false,
              "Minimum": "NaN",
              "Maximum": "NaN",
              "Interval": "NaN",
              "DateTimeAxis": false,
              "CrossesAtZero": false
            }
          ],
          "LegendPosition": 0,
          "LegendOrientation": 0,
          "AnnotationPosition": 0,
          "DisabledSeries": [],
          "LegendOutsideGraph": false,
          "Name": "PlantParts",
          "Children": [
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -16736653,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "RedClover.Leaf.Live.Wt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Leaf",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -16777216,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 2,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "RedClover.Stem.Live.Wt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Stem",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -11094807,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "RedClover.Inflorescence.Live.Wt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Inflorescence",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -990142,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "RedClover.Taproot.Live.Wt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Taproot",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -2793984,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "RedClover.Root.Live.Wt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Root",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            }
          ],
          "IncludeInDocumentation": true,
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Graph, Models",
          "Caption": null,
          "Axis": [
            {
              "$type": "Models.Axis, Models",
              "Type": 3,
              "Title": "Date",
              "Inverted": false,
              "Minimum": "NaN",
              "Maximum": "NaN",
              "Interval": "NaN",
              "DateTimeAxis": false,
              "CrossesAtZero": false
            },
            {
              "$type": "Models.Axis, Models",
              "Type": 0,
              "Title": null,
              "Inverted": false,
              "Minimum": "NaN",
              "Maximum": "NaN",
              "Interval": "NaN",
              "DateTimeAxis": false,
              "CrossesAtZero": false
            },
            {
              "$type": "Models.Axis, Models",
              "Type": 2,
              "Title": null,
              "Inverted": false,
              "Minimum": "NaN",
              "Maximum": "NaN",
              "Interval": "NaN",
              "DateTimeAxis": false,
              "CrossesAtZero": false
            }
          ],
          "LegendPosition": 0,
          "LegendOrientation": 0,
          "AnnotationPosition": 0,
          "DisabledSeries": [],
          "LegendOutsideGraph": false,
          "Name": "Harvests",
          "Children": [
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -16736653,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "HarvestedWt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Events",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 2,
              "ColourArgb": -16777216,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "HarvestedWt",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": true,
              "CumulativeX": false,
              "Filter": null,
              "Name": "Cumulative",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            }
          ],
          "IncludeInDocumentation": true,
          "Enabled": true,
          "ReadOnly": false
        },
        {
          "$type": "Models.Graph, Models",
          "Caption": null,
          "Axis": [
            {
              "$type": "Models.Axis, Models",
              "Type": 3,
              "Title": "Date",
              "Inverted": false,
              "Minimum": "NaN",
              "Maximum": "NaN",
              "Interval": "NaN",
              "DateTimeAxis": false,
              "CrossesAtZero": false
            },
            {
              "$type": "Models.Axis, Models",
              "Type": 0,
              "Title": null,
              "Inverted": false,
              "Minimum": "NaN",
              "Maximum": "NaN",
              "Interval": "NaN",
              "DateTimeAxis": false,
              "CrossesAtZero": false
            }
          ],
          "LegendPosition": 0,
          "LegendOrientation": 0,
          "AnnotationPosition": 0,
          "DisabledSeries": [],
          "LegendOutsideGraph": false,
          "Name": "Water",
          "Children": [
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -16747854,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "TotalSWC",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "WaterContent",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -16777216,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "TotalDUL",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "DUL",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            },
            {
              "$type": "Models.Series, Models",
              "Type": 1,
              "XAxis": 3,
              "YAxis": 0,
              "ColourArgb": -2793984,
              "FactorToVaryColours": null,
              "FactorToVaryMarkers": null,
              "FactorToVaryLines": null,
              "Marker": 11,
              "MarkerSize": 0,
              "Line": 0,
              "LineThickness": 0,
              "TableName": "Report",
              "XFieldName": "Date",
              "YFieldName": "TotalLL15",
              "X2FieldName": "",
              "Y2FieldName": "",
              "ShowInLegend": true,
              "IncludeSeriesNameInLegend": false,
              "Cumulative": false,
              "CumulativeX": false,
              "Filter": null,
              "Name": "LL15",
              "Children": [],
              "IncludeInDocumentation": true,
              "Enabled": true,
              "ReadOnly": false
            }
          ],
          "IncludeInDocumentation": true,
          "Enabled": true,
          "ReadOnly": false
        }
      ],
      "IncludeInDocumentation": true,
      "Enabled": true,
      "ReadOnly": false
    }
  ],
  "IncludeInDocumentation": true,
  "Enabled": true,
  "ReadOnly": false
}